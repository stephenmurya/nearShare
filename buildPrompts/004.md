# Build Step 004: Handover Workflow (QR & Agreement)

## Task Description
Implement the trust layer: digital rental agreements and QR-based handover confirmation.

## Discovery
- [schemas/rental_agreements.md](file:///c:/Users/USER/Documents/dev/nearShare/buildPrompts/schemas/rental_agreements.md)
- [pages/qr_handover_screen.md](file:///c:/Users/USER/Documents/dev/nearShare/buildPrompts/pages/qr_handover_screen.md)

## PROMPT
Build the handover verification system:
1. **Agreement**: Implement `RentalAgreementScreen` where the renter must sign on a canvas before proceeding. Save the signature hash/URL to Firestore.
2. **Handover (QR)**: Implement `QRHandoverScreen`:
   - Owner side: Generate a QR code containing the `rental_id` and a secret token.
   - Renter side: Use `mobile_scanner` to scan the QR.
3. **Verification**: Call the `handover/verify` endpoint (or equivalent direct Firestore transaction) to mark the item as "Handed Over."
4. Repeat the flow for the "Return" phase.

## SUCCESS CRITERIA
- Signature pad captures and saves the user signature.
- QR code is generated and successfully scanned by another device emulator.
- Rental status updates in real-time on both devices after scan.

## VERIFICATION PROMPT
"Verify the QR generation logic. Simulate a scan event and check if the Firestore transaction atomicly updates the status to 'active'."

---
Generated by VisualPRD
